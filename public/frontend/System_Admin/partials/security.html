<div class="space-y-6">
    <script>
// Mock data for development
const MOCK_SESSIONS = [
    {
        sessionId: 'sess_12345',
        userName: 'System Admin',
        email: 'admin@canemap.com',
        role: 'admin',
        ipAddress: '192.168.1.100',
        loginTime: new Date(Date.now() - 3600000).toISOString(), // 1 hour ago
        lastActivity: new Date().toISOString()
    },
    {
        sessionId: 'sess_67890',
        userName: 'John Doe',
        email: 'john@example.com',
        role: 'user',
        ipAddress: '192.168.1.101',
        loginTime: new Date(Date.now() - 1800000).toISOString(), // 30 minutes ago
        lastActivity: new Date(Date.now() - 300000).toISOString() // 5 minutes ago
    }
];

// Function to fetch active sessions
async function fetchActiveSessions() {
    const sessionsTableBody = document.getElementById('sessionsTableBody');
    
    // Show loading state
    sessionsTableBody.innerHTML = `
        <tr>
            <td colspan="6" class="px-6 py-10">
                <div class="flex flex-col items-center justify-center text-center text-gray-500">
                    <i class="fas fa-spinner fa-spin text-2xl mb-2 text-gray-400"></i>
                    <p>Loading sessions...</p>
                </div>
            </td>
        </tr>`;

    try {
        // Try to fetch from real API first
        const response = await fetch('/api/security/sessions', {
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            credentials: 'same-origin' // Include cookies for authentication
        });

        if (response.ok) {
            const data = await response.json();
            updateSessionsUI(data);
        } else {
            // If API fails, use mock data for development
            console.warn('Using mock session data. Backend API not available.');
            updateSessionsUI(MOCK_SESSIONS);
            
            // Show info message that mock data is being used
            showNotification('Using demo data - Backend API not available', 'info');
        }
    } catch (error) {
        console.error('Error fetching active sessions:', error);
        
        // Fallback to mock data if there's an error
        updateSessionsUI(MOCK_SESSIONS);
        
        // Show error message but still display mock data
        showNotification('Using demo data - ' + error.message, 'warning');
    }
}

// Update UI with session data
function updateSessionsUI(sessions) {
    const sessionsTableBody = document.getElementById('sessionsTableBody');
    
    if (!sessions || sessions.length === 0) {
        sessionsTableBody.innerHTML = `
            <tr>
                <td colspan="6" class="px-6 py-10 text-center text-gray-500">
                    No active sessions found
                </td>
            </tr>`;
        return;
    }

    // Update the active sessions count
    document.getElementById('activeSessionsCount').textContent = sessions.length;
    
    // Generate table rows
    const rows = sessions.map(session => `
        <tr class="hover:bg-gray-50">
            <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center">
                        <i class="fas fa-user text-gray-600"></i>
                    </div>
                    <div class="ml-4">
                        <div class="text-sm font-medium text-gray-900">${session.userName || 'Unknown User'}</div>
                        <div class="text-sm text-gray-500">${session.email || ''}</div>
                    </div>
                </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-${getRoleColor(session.role || 'user')}-100 text-${getRoleColor(session.role || 'user')}-800">
                    ${session.role || 'User'}
                </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                ${session.ipAddress || 'N/A'}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                ${formatDate(session.loginTime) || 'N/A'}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                ${formatRelativeTime(session.lastActivity) || 'Just now'}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                <button onclick="endSession('${session.sessionId}')" class="text-red-600 hover:text-red-900 mr-4">
                    <i class="fas fa-sign-out-alt"></i> End
                </button>
            </td>
        </tr>
    `).join('');

    sessionsTableBody.innerHTML = rows;
}

// Helper function to get color based on role
function getRoleColor(role) {
    const roles = {
        'admin': 'red',
        'moderator': 'blue',
        'user': 'green',
        'guest': 'yellow'
    };
    return roles[role.toLowerCase()] || 'gray';
}

// Format date to readable string
function formatDate(dateString) {
    if (!dateString) return '';
    const options = { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    };
    return new Date(dateString).toLocaleDateString(undefined, options);
}

// Format relative time (e.g., "2 minutes ago")
function formatRelativeTime(dateString) {
    if (!dateString) return '';
    const date = new Date(dateString);
    const now = new Date();
    const diffInSeconds = Math.floor((now - date) / 1000);
    
    if (diffInSeconds < 60) return 'Just now';
    if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}m ago`;
    if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h ago`;
    return `${Math.floor(diffInSeconds / 86400)}d ago`;
}

// End a specific session
async function endSession(sessionId) {
    if (!confirm('Are you sure you want to end this session?')) return;
    
    try {
        const response = await fetch(`/api/security/sessions/${sessionId}`, {
            method: 'DELETE'
        });
        
        if (!response.ok) {
            throw new Error('Failed to end session');
        }
        
        // Refresh the sessions list
        fetchActiveSessions();
        showNotification('Session ended successfully', 'success');
    } catch (error) {
        console.error('Error ending session:', error);
        showNotification('Failed to end session', 'error');
    }
}

// Show notification
function showNotification(message, type = 'info') {
    // You can replace this with your preferred notification system
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg text-white ${
        type === 'success' ? 'bg-green-500' : 
        type === 'error' ? 'bg-red-500' : 'bg-blue-500'
    }`;
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 5000);
}

// Refresh sessions
function refreshSessions() {
    fetchActiveSessions();
}

// Initialize the security tab
function initializeSecurity() {
    // Load active sessions when the tab is first shown
    fetchActiveSessions();
    
    // Set up auto-refresh every 30 seconds
    setInterval(fetchActiveSessions, 30000);
}

// Expose functions to the global scope
window.fetchActiveSessions = fetchActiveSessions;
window.refreshSessions = refreshSessions;
window.initializeSecurity = initializeSecurity;

// Initialize when the document is ready
document.addEventListener('DOMContentLoaded', initializeSecurity);
</script>

<!-- Security Overview Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Active Sessions -->
        <div class="bg-white rounded-xl p-6 card-shadow border border-gray-100">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Active Sessions</p>
                    <p class="text-3xl font-bold text-gray-900" id="activeSessionsCount">0</p>
                </div>
                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                    <i class="fas fa-users text-blue-600 text-xl"></i>
                </div>
            </div>
            <div class="mt-4 flex items-center text-sm">
                <span class="text-green-600 font-medium" id="sessionsChange">+0</span>
                <span class="text-gray-500 ml-2">from last hour</span>
            </div>
        </div>

        <!-- Failed Logins -->
        <div class="bg-white rounded-xl p-6 card-shadow border border-gray-100">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Failed Logins</p>
                    <p class="text-3xl font-bold text-gray-900" id="failedLoginsCount">0</p>
                </div>
                <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                </div>
            </div>
            <div class="mt-4 flex items-center text-sm">
                <span class="text-red-600 font-medium" id="failedLoginsChange">+0</span>
                <span class="text-gray-500 ml-2">today</span>
            </div>
        </div>

        <!-- Locked Accounts -->
        <div class="bg-white rounded-xl p-6 card-shadow border border-gray-100">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Locked Accounts</p>
                    <p class="text-3xl font-bold text-gray-900" id="lockedAccountsCount">0</p>
                </div>
                <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                    <i class="fas fa-lock text-yellow-600 text-xl"></i>
                </div>
            </div>
            <div class="mt-4 flex items-center text-sm">
                <span class="text-yellow-600 font-medium" id="lockedAccountsChange">+0</span>
                <span class="text-gray-500 ml-2">this week</span>
            </div>
        </div>

        <!-- Security Policies -->
        <div class="bg-white rounded-xl p-6 card-shadow border border-gray-100">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Active Policies</p>
                    <p class="text-3xl font-bold text-gray-900" id="activePoliciesCount">0</p>
                </div>
                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                    <i class="fas fa-shield-alt text-green-600 text-xl"></i>
                </div>
            </div>
            <div class="mt-4 flex items-center text-sm">
                <span class="text-green-600 font-medium" id="policiesChange">+0</span>
                <span class="text-gray-500 ml-2">configured</span>
            </div>
        </div>
    </div>

    <!-- Security Management Tabs -->
    <div class="bg-white rounded-xl card-shadow">
        <div class="border-b border-gray-200">
            <nav class="flex space-x-8 px-6" aria-label="Tabs">
                <button onclick="showSecurityTab('sessions')" class="security-tab active py-4 px-1 border-b-2 border-[var(--cane-600)] font-medium text-sm text-[var(--cane-600)]" id="tab-sessions">
                    <i class="fas fa-users mr-2"></i>Active Sessions
                </button>
                <button onclick="showSecurityTab('roles')" class="security-tab py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" id="tab-roles">
                    <i class="fas fa-user-shield mr-2"></i>Role Permissions
                </button>
                <button onclick="showSecurityTab('logs')" class="security-tab py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" id="tab-logs">
                    <i class="fas fa-history mr-2"></i>System Logs
                </button>
                <button onclick="showSecurityTab('login-history')" class="security-tab py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" id="tab-login-history">
                    <i class="fas fa-sign-in-alt mr-2"></i>Login History
                </button>
                <button onclick="showSecurityTab('policies')" class="security-tab py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" id="tab-policies">
                    <i class="fas fa-cog mr-2"></i>Global Policies
                </button>
                <button onclick="showSecurityTab('accounts')" class="security-tab py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300" id="tab-accounts">
                    <i class="fas fa-user-lock mr-2"></i>Account Management
                </button>
            </nav>
        </div>

        <!-- Tab Content -->
        <div class="p-6">
            <!-- Active Sessions Tab -->
            <div id="content-sessions" class="security-tab-content">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Active User Sessions</h3>
                    <button onclick="refreshSessions()" class="px-4 py-2 bg-[var(--cane-600)] text-white rounded-lg hover:bg-[var(--cane-700)] transition-colors">
                        <i class="fas fa-sync-alt mr-2"></i>Refresh
                    </button>
                </div>
                
                <div class="overflow-hidden border border-gray-200 rounded-xl">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">User</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Role</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">IP Address</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Login Time</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Last Activity</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="sessionsTableBody" class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td colspan="6" class="px-6 py-10">
                                    <div class="flex flex-col items-center justify-center text-center text-gray-500">
                                        <i class="fas fa-spinner fa-spin text-2xl mb-2 text-gray-400"></i>
                                        <p>Loading sessions...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Role Permissions Tab -->
            <div id="content-roles" class="security-tab-content hidden">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Role-Based Access Control</h3>
                    <button onclick="openRoleModal()" class="px-4 py-2 bg-[var(--cane-600)] text-white rounded-lg hover:bg-[var(--cane-700)] transition-colors">
                        <i class="fas fa-plus mr-2"></i>Add Role
                    </button>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900">Available Roles</h4>
                        <div id="rolesList" class="space-y-2">
                            <!-- Roles will be loaded here -->
                        </div>
                    </div>
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900">Permissions</h4>
                        <div id="permissionsList" class="space-y-2">
                            <!-- Permissions will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Logs Tab -->
            <div id="content-logs" class="security-tab-content hidden">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">System-Wide Security Logs</h3>
                    <div class="flex gap-2">
                        <select id="logLevelFilter" class="px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-[var(--cane-500)]">
                            <option value="all">All Levels</option>
                            <option value="info">Info</option>
                            <option value="warning">Warning</option>
                            <option value="error">Error</option>
                            <option value="critical">Critical</option>
                        </select>
                        <button onclick="refreshLogs()" class="px-4 py-2 bg-[var(--cane-600)] text-white rounded-lg hover:bg-[var(--cane-700)] transition-colors">
                            <i class="fas fa-sync-alt mr-2"></i>Refresh
                        </button>
                    </div>
                </div>
                
                <div class="bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto">
                    <div id="systemLogs" class="space-y-2">
                        <!-- Logs will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Login History Tab -->
            <div id="content-login-history" class="security-tab-content hidden">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">All Users Login History</h3>
                    <div class="flex gap-2">
                        <input type="date" id="loginHistoryDate" class="px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-[var(--cane-500)]">
                        <button onclick="refreshLoginHistory()" class="px-4 py-2 bg-[var(--cane-600)] text-white rounded-lg hover:bg-[var(--cane-700)] transition-colors">
                            <i class="fas fa-sync-alt mr-2"></i>Refresh
                        </button>
                    </div>
                </div>
                
                <div class="overflow-hidden border border-gray-200 rounded-xl">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">User</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Role</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Login Time</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">IP Address</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Duration</th>
                            </tr>
                        </thead>
                        <tbody id="loginHistoryTableBody" class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td colspan="6" class="px-6 py-10">
                                    <div class="flex flex-col items-center justify-center text-center text-gray-500">
                                        <i class="fas fa-spinner fa-spin text-2xl mb-2 text-gray-400"></i>
                                        <p>Loading login history...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Global Policies Tab -->
            <div id="content-policies" class="security-tab-content hidden">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Global Security Policies</h3>
                    <button onclick="openPolicyModal()" class="px-4 py-2 bg-[var(--cane-600)] text-white rounded-lg hover:bg-[var(--cane-700)] transition-colors">
                        <i class="fas fa-plus mr-2"></i>Add Policy
                    </button>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900">Password Policies</h4>
                        <div class="bg-gray-50 rounded-lg p-4 space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Minimum Password Length</span>
                                <span class="text-sm font-medium" id="minPasswordLength">8</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Require Special Characters</span>
                                <span class="text-sm font-medium" id="requireSpecialChars">Yes</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Password Expiry (days)</span>
                                <span class="text-sm font-medium" id="passwordExpiry">90</span>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900">Session Policies</h4>
                        <div class="bg-gray-50 rounded-lg p-4 space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Session Timeout (minutes)</span>
                                <span class="text-sm font-medium" id="sessionTimeout">30</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Max Failed Attempts</span>
                                <span class="text-sm font-medium" id="maxFailedAttempts">5</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-gray-700">Account Lockout Duration (minutes)</span>
                                <span class="text-sm font-medium" id="lockoutDuration">15</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Account Management Tab -->
            <div id="content-accounts" class="security-tab-content hidden">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Account Lock/Unlock Management</h3>
                    <div class="flex gap-2">
                        <input type="text" id="accountSearch" placeholder="Search by name or email..." class="px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-[var(--cane-500)]">
                        <button onclick="refreshAccounts()" class="px-4 py-2 bg-[var(--cane-600)] text-white rounded-lg hover:bg-[var(--cane-700)] transition-colors">
                            <i class="fas fa-sync-alt mr-2"></i>Refresh
                        </button>
                    </div>
                </div>
                
                <div class="overflow-hidden border border-gray-200 rounded-xl">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">User</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Role</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Last Login</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Failed Attempts</th>
                                <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="accountsTableBody" class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td colspan="6" class="px-6 py-10">
                                    <div class="flex flex-col items-center justify-center text-center text-gray-500">
                                        <i class="fas fa-spinner fa-spin text-2xl mb-2 text-gray-400"></i>
                                        <p>Loading accounts...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Role Management Modal -->
<div id="roleModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4">
        <div class="p-6 border-b border-gray-200">
            <div class="flex items-center justify-between">
                <h3 class="text-lg font-bold text-gray-900">Manage Role Permissions</h3>
                <button onclick="closeRoleModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="p-6">
            <form id="roleForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Role Name</label>
                    <input type="text" id="roleName" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--cane-500)]">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Permissions</label>
                    <div id="permissionsCheckboxes" class="grid grid-cols-2 gap-2">
                        <!-- Permissions will be loaded here -->
                    </div>
                </div>
                <div class="flex items-center justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeRoleModal()" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-[var(--cane-600)] text-white rounded-lg hover:bg-[var(--cane-700)] transition-colors">Save Role</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Policy Management Modal -->
<div id="policyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4">
        <div class="p-6 border-b border-gray-200">
            <div class="flex items-center justify-between">
                <h3 class="text-lg font-bold text-gray-900">Configure Security Policy</h3>
                <button onclick="closePolicyModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="p-6">
            <form id="policyForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Policy Type</label>
                    <select id="policyType" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--cane-500)]">
                        <option value="password">Password Policy</option>
                        <option value="session">Session Policy</option>
                        <option value="access">Access Policy</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Policy Value</label>
                    <input type="text" id="policyValue" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--cane-500)]">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea id="policyDescription" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--cane-500)]"></textarea>
                </div>
                <div class="flex items-center justify-end space-x-3 pt-4">
                    <button type="button" onclick="closePolicyModal()" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-[var(--cane-600)] text-white rounded-lg hover:bg-[var(--cane-700)] transition-colors">Save Policy</button>
                </div>
            </form>
        </div>
    </div>
</div>
