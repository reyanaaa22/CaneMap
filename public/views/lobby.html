<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CaneMap - Agricultural Decision Support Platform</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Leaflet CSS and JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
     <!-- Lottie Animation -->
     <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.6.2/dist/dotlottie-wc.js" type="module"></script>
    <style>
        .swiper {
            width: 100%;
            padding: 50px 0;
        }
        .feature-card {
            transition: transform 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-10px);
        }
			/* Green-tinted header shadow */
			.shadow-green-md {
				box-shadow: 0 4px 14px rgba(94, 165, 0, 0.35);
        }
        
        /* Scroll animations */
        .fade-in-up {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
        }
        
        .fade-in-up.animate {
            opacity: 1;
            transform: translateY(0);
        }
        
        .fade-in-left {
            opacity: 0;
            transform: translateX(-30px);
            transition: all 0.6s ease;
        }
        
        .fade-in-left.animate {
            opacity: 1;
            transform: translateX(0);
        }
        
        .fade-in-right {
            opacity: 0;
            transform: translateX(30px);
            transition: all 0.6s ease;
        }
        
        .fade-in-right.animate {
            opacity: 1;
            transform: translateX(0);
        }
        
        .scale-in {
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.6s ease;
        }
        
        .scale-in.animate {
            opacity: 1;
            transform: scale(1);
        }
        
        .slide-in-bottom {
            opacity: 0;
            transform: translateY(50px);
            transition: all 0.8s ease;
        }
        
        .slide-in-bottom.animate {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
    <body class="bg-gradient-to-br from-[var(--cane-50)] to-[var(--cane-100)] min-h-screen">
    <style>
        :root {
            --cane-50: #f7fee7;
            --cane-100: #ecfcca;
            --cane-200: #d8f999;
            --cane-300: #bbf451;
            --cane-400: #9ae600;
            --cane-500: #7ccf00;
            --cane-600: #5ea500;
            --cane-700: #497d00;
            --cane-800: #3c6300;
            --cane-900: #35530e;
            --cane-950: #192e03;
        }
    </style>
    <!-- Small green header bar -->
    <div class="w-full h-2 bg-gradient-to-r from-[var(--cane-600)] to-[var(--cane-700)]"></div>
    <!-- Header/Navigation -->
	<header class="bg-gradient-to-r from-white to-[var(--cane-50)] shadow-green-md sticky top-0 z-50 border-b-2 border-[var(--cane-200)]">
        <nav class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                     <h1 class="text-2xl font-bold bg-gradient-to-r from-[var(--cane-600)] to-[var(--cane-700)] bg-clip-text text-transparent cursor-pointer hover:from-[var(--cane-700)] hover:to-[var(--cane-800)] transition-all duration-300" onclick="scrollToTop()">CaneMap</h1>
                </div>
                <div class="flex-1 flex justify-center">
                     <div class="flex space-x-10"> <!-- Navigation menu centered -->
                          <a href="#features" class="text-[var(--cane-900)] hover:text-[var(--cane-700)] transition-colors text-lg font-semibold">Features</a>
                          <a href="#about" class="text-[var(--cane-900)] hover:text-[var(--cane-700)] transition-colors text-lg font-semibold">About us</a>
                          <a href="#contact" class="text-[var(--cane-900)] hover:text-[var(--cane-700)] transition-colors text-lg font-semibold">Contact</a>
                    </div>
                </div>
                                
                     <button class="bg-gradient-to-r from-[var(--cane-700)] to-[var(--cane-800)] text-white px-4 py-2 rounded-lg hover:from-[var(--cane-800)] hover:to-[var(--cane-900)] transition-all duration-300 transform hover:scale-105 shadow-md font-semibold" onclick="window.location.href='register-field.html'">
                         + Register a Field
                     </button>
                     <!-- Profile Dropdown -->
                     <div class="relative">
                         <button id="profileDropdownBtn" class="flex items-center space-x-2 text-[var(--cane-900)] hover:text-[var(--cane-700)] transition-all duration-300">
                             <div class="w-8 h-8 bg-gradient-to-br from-[var(--cane-400)] to-[var(--cane-500)] rounded-full flex items-center justify-center shadow-md ml-1">
                                 <i class="fas fa-user text-white text-sm"></i>
                             </div>
                             <span class="font-semibold" id="userName">Farmer Name</span>
                             <i class="fas fa-chevron-down text-[var(--cane-700)] text-xs transition-transform duration-300" id="dropdownArrow"></i>
                         </button>
                         
                         <!-- Dropdown Menu -->
                         <div id="profileDropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-[var(--cane-200)] opacity-0 invisible transition-all duration-300 transform scale-95 origin-top-right z-50">
                             <div class="py-2">
                                 <div class="px-4 py-3 border-b border-[var(--cane-100)]">
                                     <p class="text-sm font-semibold text-[var(--cane-950)]" id="dropdownUserName">Farmer Name</p>
                                     <p class="text-xs text-[var(--cane-700)] font-medium">Farmer</p>
                                 </div>
                                 <a href="Workers.html" class="flex items-center px-4 py-2 text-sm text-[var(--cane-800)] hover:bg-[var(--cane-50)] transition-colors font-medium">
                                     <i class="fas fa-tachometer-alt mr-3 text-[var(--cane-500)]"></i>
                                     Dashboard

                                 <div class="border-t border-[var(--cane-100)] mt-2">
                                     <a href="#" class="flex items-center px-4 py-2 text-sm text-[var(--cane-800)] hover:bg-[var(--cane-50)] transition-colors font-medium">
                                         <i class="fas fa-cog mr-3 text-[var(--cane-500)]"></i>
                                         Settings
                                     </a>
                                     <a href="#" class="flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors">
                                         <i class="fas fa-sign-out-alt mr-3"></i>
                                         Logout
                                     </a>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
            </div>
        </nav>
    </header>

    <!-- Main Content Area -->
    <main class="w-full min-h-screen py-8 px-2 bg-gradient-to-br from-[var(--cane-100)] to-[var(--cane-200)]">
    <div id="mainContent" class="w-full px-4 pb-8 flex flex-col lg:flex-row gap-8">
            <!-- Left Panel - Sugarcane Field Map -->
            <div id="mapPanel" class="flex-1 fade-in-left">
                                                  <div class="flex justify-between items-center mb-6">
                     <h2 class="text-2xl font-bold text-[var(--cane-950)]">Sugarcane Field Map</h2>
                     <div class="flex items-center space-x-4">
                         <input type="text" placeholder="Search for sugarcane fields..." class="w-[500px] px-4 py-3 border-2 border-[var(--cane-400)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--cane-500)] focus:border-[var(--cane-500)] bg-white shadow-md text-gray-700 placeholder-gray-600">
                         <button class="bg-gradient-to-r from-[var(--cane-700)] to-[var(--cane-800)] text-white px-6 py-3 rounded-lg hover:from-[var(--cane-800)] hover:to-[var(--cane-900)] transition-all duration-300 transform hover:scale-105 shadow-lg font-semibold">Search</button>
                         <button id="expandMapBtn" class="bg-[var(--cane-700)] text-white px-4 py-3 rounded-lg hover:bg-[var(--cane-800)] transition-all duration-300 transform hover:scale-105 shadow-md">Expand Map</button>
                     </div>
                 </div>
                <!-- Map Container -->
                <div class="relative scale-in">
                    <div id="expandMapIcon" class="absolute top-4 right-4 z-10 bg-white rounded-full shadow-lg p-3 cursor-pointer hover:bg-[var(--cane-100)] transition-all duration-300 transform hover:scale-110">
                        <i id="expandIcon" class="fas fa-expand text-[var(--cane-600)] text-2xl"></i>
                    </div>
                    <div id="refreshMapIcon" class="absolute top-4 right-16 z-10 bg-white rounded-full shadow-lg p-3 cursor-pointer hover:bg-[var(--cane-100)] transition-all duration-300 transform hover:scale-110" title="Refresh Map">
                        <i class="fas fa-sync-alt text-[var(--cane-600)] text-xl"></i>
                    </div>
                    <div id="map" class="w-full h-96 rounded-xl border-2 border-[var(--cane-400)] mb-6 shadow-xl"></div>
                </div>
                
                <script>
                    // Initialize the map
                    let map;
                    function initMap() {
                        try {
                            // Check if map is already initialized
                            if (map) {
                                console.log('Map already initialized, skipping...');
                                return;
                            }
                            
                            // Check if the map container exists and is empty
                            const mapContainer = document.getElementById('map');
                            if (!mapContainer) {
                                console.error('Map container not found');
                                return;
                            }
                            
                            // Clear any existing content
                            mapContainer.innerHTML = '';
                            
                            // Initialize the map centered on Ormoc City, Philippines
                            map = L.map('map').setView([11.0064, 124.6075], 12);
                            
                            // Add OpenStreetMap tiles
                            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                                attribution: '© OpenStreetMap contributors'
                            }).addTo(map);

                            // Add a subtle marker for Ormoc City center
                            L.marker([11.0064, 124.6075])
                                .addTo(map)
                                .bindPopup('<b>Ormoc City</b><br>Leyte, Philippines<br><small>SRA Ormoc Mill District</small>')
                                .openPopup();

                            console.log('Map initialized successfully');
                        } catch (error) {
                            console.error('Error initializing map:', error);
                            // Show error message in map container
                            document.getElementById('map').innerHTML = `
                                <div class="flex items-center justify-center h-full bg-red-50 text-red-600">
                                    <div class="text-center">
                                        <i class="fas fa-exclamation-triangle text-2xl mb-2"></i>
                                        <p>Error loading map</p>
                                        <p class="text-sm">${error.message}</p>
                                    </div>
                                </div>
                            `;
                        }
                    }
                    
                    // Function to destroy and reinitialize map
                    function reinitMap() {
                        if (map) {
                            map.remove();
                            map = null;
                        }
                        setTimeout(() => {
                            initMap();
                        }, 100);
                    }

                    // Initialize map when page loads
                    document.addEventListener('DOMContentLoaded', function() {
                        setTimeout(() => {
                            initMap();
                        }, 100);
                    });
                    
                    // Also try to initialize on window load as backup
                    window.addEventListener('load', function() {
                        if (!map) {
                            setTimeout(() => {
                                initMap();
                            }, 200);
                        }
                    });
                    
                    // Add refresh button functionality
                    document.addEventListener('DOMContentLoaded', function() {
                        const refreshBtn = document.getElementById('refreshMapIcon');
                        if (refreshBtn) {
                            refreshBtn.addEventListener('click', function() {
                                console.log('Refreshing map...');
                                reinitMap();
                            });
                        }
                    });
                </script>
                <!-- Get Verified Section -->
                 <div class="bg-gradient-to-br from-[var(--cane-200)] to-[var(--cane-300)] rounded-xl p-6 shadow-lg border border-[var(--cane-400)] slide-in-bottom">
                     <h3 class="font-bold text-[var(--cane-950)] mb-4 text-lg">Get Verified for Additional Roles</h3>
                    <div class="flex items-center justify-between">
                        <div>
                             <h4 class="font-semibold text-[var(--cane-950)] text-lg mb-2">Apply for Driver Badge</h4>
                             <p class="text-[var(--cane-900)] font-medium">Own or operate hauling vehicles? Drivers are for hauling agricultural field workers.</p>
                        </div>
                         <button onclick="window.location.href='Driver_Badge.html'" class="bg-gradient-to-r from-[var(--cane-800)] to-[var(--cane-900)] text-white px-6 py-3 rounded-lg hover:from-[var(--cane-900)] hover:to-[var(--cane-950)] transition-all duration-300 transform hover:scale-105 shadow-lg font-semibold">Apply Now</button>
                    </div>
                </div>
            </div>
            <!-- Right Panel -->
            <div id="sidePanel" class="w-full lg:w-96 space-y-4 fade-in-right">
                                 <!-- Notifications -->
                                  <div class="bg-gradient-to-br from-white to-[var(--cane-100)] rounded-xl shadow-lg p-6 border border-[var(--cane-300)]">
                      <h3 class="text-lg font-bold text-[var(--cane-950)] mb-6 flex items-center">
                          <i class="fas fa-bell text-[var(--cane-500)] mr-3 text-xl"></i>
                          Notifications
                      </h3>
                     <div class="space-y-3">
                          <div class="flex items-start space-x-3 p-3 bg-gradient-to-r from-[var(--cane-100)] to-[var(--cane-200)] rounded-lg border-l-4 border-[var(--cane-500)]">
                              <div class="w-10 h-10 bg-gradient-to-br from-[var(--cane-500)] to-[var(--cane-600)] rounded-full flex items-center justify-center flex-shrink-0 mt-1 shadow-md">
                                  <i class="fas fa-check text-white text-base"></i>
                             </div>
                             <div>
                                  <h4 class="font-semibold text-[var(--cane-950)]">Your Request Approved</h4>
                                  <p class="text-[var(--cane-900)] text-sm font-medium">Payment has been accepted by SRA for field registration.</p>
                             </div>
                         </div>
                          <div class="flex items-start space-x-3 p-3 bg-gradient-to-r from-[var(--cane-100)] to-[var(--cane-200)] rounded-lg border-l-4 border-[var(--cane-400)]">
                              <div class="w-10 h-10 bg-gradient-to-br from-[var(--cane-400)] to-[var(--cane-500)] rounded-full flex items-center justify-center flex-shrink-0 mt-1 shadow-md">
                                  <i class="fas fa-clipboard text-white text-base"></i>
                             </div>
                             <div>
                                  <h4 class="font-semibold text-[var(--cane-950)]">Task assignment</h4>
                                  <p class="text-[var(--cane-900)] text-sm font-medium">New weeding task assigned for this week.</p>
                             </div>
                         </div>
                     </div>
                 </div>
                                 <!-- Weather Forecast -->
                  <div class="bg-gradient-to-br from-white to-[var(--cane-100)] rounded-xl shadow-lg p-6 border border-[var(--cane-300)]">
                      <h3 class="text-lg font-bold text-[var(--cane-950)] mb-4 flex items-center">
                          <i class="fas fa-cloud-sun text-[var(--cane-500)] mr-3 text-xl"></i>
                          Weather Forecast
                      </h3>
                     <div class="space-y-2" id="weatherForecast">
                         <!-- Weather data will be populated by JavaScript -->
                     </div>
                 </div>
            </div>
        </div>
    </main>
    <!-- Features Section -->
	<section id="features" class="relative bg-[#0b1020]">
		<div id="featuresInner" class="relative w-full px-6 py-32 min-h-screen overflow-hidden">
			<!-- Background image + gradient overlay -->
			<div class="absolute inset-0">
				<img id="featuresBg" src="../img/sugarcane.webp" alt="Sugarcane background" class="absolute inset-0 w-full h-full object-cover opacity-40">
				<img id="featuresBgSwap" src="" alt="" class="absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-700">
				<div class="absolute inset-0 bg-gradient-to-r from-[#0b1020] via-[#0b1020]/70 to-transparent"></div>
				<!-- top and bottom fade to remove any white edges -->
				<div class="absolute top-0 left-0 right-0 h-32 bg-gradient-to-b from-[#0b1020] to-transparent"></div>
				<div class="absolute bottom-0 left-0 right-0 h-20 bg-gradient-to-t from-[#0b1020] to-transparent"></div>
			</div>

			<div class="relative grid grid-cols-1 lg:grid-cols-12 gap-8 items-center justify-center">
				<!-- Left information panel -->
				<div class="lg:col-span-6 flex justify-center fade-in-left">
					<div class="bg-white/5 backdrop-blur rounded-xl border border-white/10 p-6 md:p-8 max-w-xl shadow-[0_0_0_9999px_rgba(11,16,32,0.35)]">
						<h2 id="featureTitle" class="text-3xl md:text-4xl font-bold text-white mb-4">CaneMap Features</h2>
						<div id="featureTags" class="flex flex-wrap items-center gap-3 text-sm text-slate-200/90 mb-4"></div>
						<p id="featureDesc" class="text-slate-200/90 leading-relaxed mb-6"></p>
						                        <div class="flex items-center gap-3">
							<button class="bg-[#22c55e] hover:bg-[#16a34a] text-white px-5 py-2.5 rounded-lg transition-colors flex items-center gap-2">
								<i class="fa-solid fa-play"></i>
								<span>Explore</span>
							</button>
						</div>
					</div>
				</div>

				<!-- Right coverflow carousel -->
				<div class="lg:col-span-6 flex justify-center fade-in-right">
					<div class="featuresSwiper swiper">
						<div class="swiper-wrapper">
							<!-- Field Registration & Mapping -->
							<div class="swiper-slide relative w-[160px] sm:w-[200px] md:w-[230px] h-[240px] sm:h-[280px] md:h-[320px] rounded-xl overflow-hidden shadow-xl" data-title="Field Registration & Mapping" data-tags="Leaflet.js,OpenStreetMap,GeoJSON" data-desc="Register sugarcane areas with precise map coordinates using Leaflet.js and OpenStreetMap. Draw plots, save geometry, and manage boundaries easily.">
								<img src="../img/Mapping.webp" alt="Field Registration & Mapping" class="w-full h-full object-cover">
								<div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
								<div class="absolute bottom-0 left-0 right-0 p-4">
									<h3 class="text-white text-lg font-semibold leading-tight">Field Registration & Mapping</h3>
									<p class="text-white/80 text-xs">Leaflet + OpenStreetMap</p>
								</div>
							</div>
							<!-- Growth Tracker & Harvest Timeline -->
							<div class="swiper-slide relative w-[160px] sm:w-[200px] md:w-[230px] h-[240px] sm:h-[280px] md:h-[320px] rounded-xl overflow-hidden shadow-xl" data-title="Growth Tracker & Harvest Timeline" data-tags="Planting date,Variety alerts,Readiness" data-desc="Set planting dates and varieties to get automatic growth stage tracking and harvest readiness alerts.">
								<img src="../img/cane.png" alt="Growth Tracker & Harvest Timeline" class="w-full h-full object-cover">
								<div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
								<div class="absolute bottom-0 left-0 right-0 p-4">
									<h3 class="text-white text-lg font-semibold leading-tight">Growth Tracker & Harvest Timeline</h3>
									<p class="text-white/80 text-xs">Planting date + variety alerts</p>
								</div>
							</div>
							<!-- Role-Based Dashboards -->
							<div class="swiper-slide relative w-[160px] sm:w-[200px] md:w-[230px] h-[240px] sm:h-[280px] md:h-[320px] rounded-xl overflow-hidden shadow-xl" data-title="Role-Based Dashboards" data-tags="Farmers,Workers,Drivers,SRA,Admins" data-desc="Separate dashboards tailored for farmers, workers, drivers, SRA officers, and admins for focused workflows.">
								<img src="../img/sugarcane.webp" alt="Role-Based Dashboards" class="w-full h-full object-cover">
								<div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
								<div class="absolute bottom-0 left-0 right-0 p-4">
									<h3 class="text-white text-lg font-semibold leading-tight">Role-Based Dashboards</h3>
									<p class="text-white/80 text-xs">Farmers, SRA officers, admins</p>
								</div>
							</div>
							<!-- Weather Forecast Integration -->
							<div class="swiper-slide relative w-[160px] sm:w-[200px] md:w-[230px] h-[240px] sm:h-[280px] md:h-[320px] rounded-xl overflow-hidden shadow-xl" data-title="Weather Forecast Integration" data-tags="3-day,Weekly,Location-based" data-desc="Get location-based 3-day and weekly weather forecasts to plan field work and logistics.">
								<img src="../img/Weather.jpg" alt="Weather Forecast Integration" class="w-full h-full object-cover">
								<div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
								<div class="absolute bottom-0 left-0 right-0 p-4">
									<h3 class="text-white text-lg font-semibold leading-tight">Weather Forecast Integration</h3>
									<p class="text-white/80 text-xs">3-day & weekly, location-based</p>
								</div>
							</div>
							<!-- Transport & Logistics Coordination -->
							<div class="swiper-slide relative w-[160px] sm:w-[200px] md:w-[230px] h-[240px] sm:h-[280px] md:h-[320px] rounded-xl overflow-hidden shadow-xl" data-title="Transport & Logistics Coordination" data-tags="Drivers,Truck rental,Deliveries" data-desc="Coordinate drivers, manage truck rentals, and track delivery updates in real-time.">
								<img src="../img/Transport.jpg" alt="Transport & Logistics Coordination" class="w-full h-full object-cover">
								<div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
								<div class="absolute bottom-0 left-0 right-0 p-4">
									<h3 class="text-white text-lg font-semibold leading-tight">Transport & Logistics Coordination</h3>
									<p class="text-white/80 text-xs">Driver module, rentals, updates</p>
                        </div>
                    </div>
							<!-- Offline Logging -->
							<div class="swiper-slide relative w-[160px] sm:w-[200px] md:w-[230px] h-[240px] sm:h-[280px] md:h-[320px] rounded-xl overflow-hidden shadow-xl" data-title="Offline Logging" data-tags="No internet,Auto-sync,Background" data-desc="Log activities without internet and automatically sync when back online.">
								<img src="../img/cane.png" alt="Offline Logging" class="w-full h-full object-cover">
								<div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
								<div class="absolute bottom-0 left-0 right-0 p-4">
									<h3 class="text-white text-lg font-semibold leading-tight">Offline Logging</h3>
									<p class="text-white/80 text-xs">Log tasks offline, auto-sync</p>
                        </div>
                    </div>
                </div>
						<div class="swiper-button-prev !text-white"></div>
						<div class="swiper-button-next !text-white"></div>
						<div class="swiper-pagination"></div>
					</div>
                </div>
            </div>
        </div>
    </section>
    <!-- About Us Section -->
    <section id="about" class="py-24 bg-gradient-to-br from-[var(--cane-50)] to-[var(--cane-100)]">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16 fade-in-up">
                <h2 class="text-5xl font-bold text-[var(--cane-950)] mb-6">About CaneMap</h2>
                <div class="w-24 h-1 bg-gradient-to-r from-[var(--cane-600)] to-[var(--cane-700)] mx-auto rounded-full"></div>
            </div>
            
            <div class="max-w-5xl mx-auto text-center mb-16 fade-in-up">
                <p class="text-xl text-[var(--cane-900)] leading-relaxed font-medium">
                    CaneMap is an agricultural decision-support platform designed to help sugarcane farmers and field workers register land, track field progress, and collaborate with the Sugar Regulatory Administration (SRA) for better transparency and productivity. Developed in collaboration with local stakeholders and SRA Ormoc Mill District, CaneMap empowers farmers through digital mapping, task coordination, and predictive analytics to make informed decisions throughout the crop cycle.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-5xl mx-auto">
                <div class="bg-white rounded-2xl shadow-xl p-10 text-center transform hover:scale-105 transition-all duration-500 border border-[var(--cane-200)] scale-in">
                    <div class="w-16 h-16 bg-gradient-to-br from-[var(--cane-500)] to-[var(--cane-600)] rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-bullseye text-white text-2xl"></i>
                    </div>
                    <h3 class="text-3xl font-bold text-[var(--cane-950)] mb-6">Our Mission</h3>
                    <p class="text-lg text-[var(--cane-900)] font-medium leading-relaxed">To empower sugarcane farmers with digital tools for better decision-making and productivity through innovative technology solutions.</p>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl p-10 text-center transform hover:scale-105 transition-all duration-500 border border-[var(--cane-200)] scale-in">
                    <div class="w-16 h-16 bg-gradient-to-br from-[var(--cane-600)] to-[var(--cane-700)] rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-eye text-white text-2xl"></i>
                    </div>
                    <h3 class="text-3xl font-bold text-[var(--cane-950)] mb-6">Our Vision</h3>
                    <p class="text-lg text-[var(--cane-900)] font-medium leading-relaxed">To be the leading agricultural technology platform for sugarcane farming in the Philippines, driving digital transformation in agriculture.</p>
                </div>
            </div>
        </div>
    </section>
    <!-- Contact Section -->
    <section id="contact" class="bg-gradient-to-br from-[var(--cane-100)] to-[var(--cane-200)] py-24">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16 fade-in-up">
                <h2 class="text-5xl font-bold text-[var(--cane-950)] mb-6">Get in Touch</h2>
                <div class="w-24 h-1 bg-gradient-to-r from-[var(--cane-600)] to-[var(--cane-700)] mx-auto rounded-full"></div>
                <p class="text-xl text-[var(--cane-900)] mt-6 max-w-2xl mx-auto">Have questions or need support? We're here to help you with your sugarcane farming needs.</p>
            </div>
            
            <div class="max-w-6xl mx-auto">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
                    <!-- Left: Contact Form -->
                    <div class="bg-white rounded-xl shadow-lg p-6 border border-[var(--cane-200)] fade-in-left max-w-sm">
                        <h3 class="text-xl font-bold text-[var(--cane-950)] mb-4">Send us a Message</h3>
                        
                        <div class="space-y-3 mb-4">
                            <div class="flex items-center space-x-2 p-2 bg-[var(--cane-50)] rounded-md">
                                <div class="w-6 h-6 bg-gradient-to-br from-[var(--cane-500)] to-[var(--cane-600)] rounded-full flex items-center justify-center">
                                    <i class="fas fa-envelope text-white text-xs"></i>
                                </div>
                                <div>
                                    <p class="text-xs text-[var(--cane-700)] font-medium">Email</p>
                                    <p class="text-[var(--cane-900)] font-semibold text-xs">info@canemap.com</p>
                                </div>
                            </div>
                            
                            <div class="flex items-center space-x-2 p-2 bg-[var(--cane-50)] rounded-md">
                                <div class="w-6 h-6 bg-gradient-to-br from-[var(--cane-600)] to-[var(--cane-700)] rounded-full flex items-center justify-center">
                                    <i class="fas fa-phone text-white text-xs"></i>
                                </div>
                                <div>
                                    <p class="text-xs text-[var(--cane-700)] font-medium">Phone</p>
                                    <p class="text-[var(--cane-900)] font-semibold text-xs">+63 912 345 6789</p>
                                </div>
                            </div>
                            
                            <div class="flex items-center space-x-2 p-2 bg-[var(--cane-50)] rounded-md">
                                <div class="w-6 h-6 bg-gradient-to-br from-[var(--cane-700)] to-[var(--cane-800)] rounded-full flex items-center justify-center">
                                    <i class="fas fa-map-marker-alt text-white text-xs"></i>
                                </div>
                                <div>
                                    <p class="text-xs text-[var(--cane-700)] font-medium">Location</p>
                                    <p class="text-[var(--cane-900)] font-semibold text-xs">SRA Ormoc Mill District, Philippines</p>
                                </div>
                            </div>
                        </div>
                        
                        <form class="space-y-3">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <input type="text" placeholder="Your Name" class="w-full px-2 py-1.5 border border-[var(--cane-300)] rounded-md focus:outline-none focus:ring-1 focus:ring-[var(--cane-500)] focus:border-[var(--cane-500)] bg-white text-xs font-medium">
                                <input type="email" placeholder="Your Email" class="w-full px-2 py-1.5 border border-[var(--cane-300)] rounded-md focus:outline-none focus:ring-1 focus:ring-[var(--cane-500)] focus:border-[var(--cane-500)] bg-white text-xs font-medium">
                            </div>
                            <textarea placeholder="Your Message" rows="3" class="w-full px-2 py-1.5 border border-[var(--cane-300)] rounded-md focus:outline-none focus:ring-1 focus:ring-[var(--cane-500)] focus:border-[var(--cane-500)] bg-white text-xs font-medium resize-none"></textarea>
                            <button type="submit" class="w-full bg-gradient-to-r from-[var(--cane-700)] to-[var(--cane-800)] text-white py-2 rounded-md hover:from-[var(--cane-800)] hover:to-[var(--cane-900)] transition-all duration-300 transform hover:scale-105 shadow-md font-semibold text-sm">Send Message</button>
                        </form>
                    </div>
                    
                    <!-- Right: Animation -->
                    <div class="flex justify-center items-center fade-in-right">
                        <dotlottie-wc src="https://lottie.host/91bcd1ed-629b-40f2-bb9c-f589f84356f9/7nRjluWgwr.lottie" style="width: 500px;height: 500px" speed="1" autoplay loop></dotlottie-wc>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Footer -->
     <footer class="bg-gradient-to-r from-[var(--cane-800)] to-[var(--cane-900)] text-white py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="text-center md:text-left mb-4 md:mb-0">
                     <p class="text-sm text-[var(--cane-200)]">© 2025 CaneMap. All rights reserved. Developed by the CaneMap Team in collaboration with SRA Ormoc Mill District.</p>
                    <div class="mt-2 space-x-4 text-sm">
                         <a href="#" class="text-[var(--cane-200)] hover:text-[var(--cane-100)] transition-colors">Terms of Service</a>
                         <a href="#" class="text-[var(--cane-200)] hover:text-[var(--cane-100)] transition-colors">Privacy Policy</a>
                         <a href="#" class="text-[var(--cane-200)] hover:text-[var(--cane-100)] transition-colors">Help Center</a>
                    </div>
                </div>
                 <button onclick="scrollToTop()" class="bg-gradient-to-br from-[var(--cane-600)] to-[var(--cane-700)] rounded-full p-3 hover:from-[var(--cane-700)] hover:to-[var(--cane-800)] transition-all duration-300 transform hover:scale-110 shadow-lg">
                    <i class="fas fa-arrow-up text-white"></i>
                </button>
            </div>
        </div>
    </footer>
    <!-- Firebase JS SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script>
        // Initialize Firebase (you'll need to add your config here)
        const firebaseConfig = {
            // Add your Firebase config here
            // apiKey: "your-api-key",
            // authDomain: "your-project.firebaseapp.com",
            // projectId: "your-project-id",
            // storageBucket: "your-project.appspot.com",
            // messagingSenderId: "123456789",
            // appId: "your-app-id"
        };
        
        // Initialize Firebase if config is provided
        if (firebaseConfig.apiKey) {
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
        }

        // Weather API integration
        async function getWeather() {
            try {
                const apiKey = '2d59a2816a02c3178386f3d51233b2ea';
                const lat = 11.0064; // Ormoc City latitude
                const lon = 124.6075; // Ormoc City longitude
                const url = `https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;
                const response = await fetch(url);
                const data = await response.json();
                const weatherContainer = document.getElementById('weatherForecast');
                
                if (!data.list) {
                    let errorMsg = 'Weather data unavailable.';
                    if (data.message) {
                        errorMsg += `<br><span class='text-xs text-[var(--cane-600)]'>API: ${data.message}</span>`;
                    }
                    weatherContainer.innerHTML = `<div class='text-[var(--cane-700)] bg-[var(--cane-50)] p-3 rounded-lg border border-[var(--cane-200)]'>${errorMsg}</div>`;
                    return;
                }
                
                // Group forecasts by day
                const days = {};
                data.list.forEach(item => {
                    const date = new Date(item.dt * 1000);
                    const dayStr = date.toLocaleDateString();
                    if (!days[dayStr]) {
                        days[dayStr] = [];
                    }
                    days[dayStr].push(item);
                });
                
                // Get today, tomorrow, and next day
                const dayKeys = Object.keys(days).slice(0, 3);
                const dayNames = ['Today', 'Tomorrow', new Date(dayKeys[2]).toLocaleDateString('en-US', { weekday: 'long' })];
                
                                    const html = dayKeys.map((key, idx) => {
                        // Use the forecast closest to noon for each day
                        const forecasts = days[key];
                        let forecast = forecasts.find(f => new Date(f.dt * 1000).getHours() === 12) || forecasts[Math.floor(forecasts.length / 2)];
                        const temp = `${Math.round(forecast.main.temp_min)}°C / ${Math.round(forecast.main.temp_max)}°C`;
                        const icon = forecast.weather[0].icon;
                        const desc = forecast.weather[0].description;
                        return `
                            <div class="flex items-center justify-between p-2 bg-gradient-to-r from-[var(--cane-50)] to-[var(--cane-100)] rounded-lg border border-[var(--cane-200)]">
                                <div class="flex items-center space-x-2">
                                    <img src="https://openweathermap.org/img/wn/${icon}@2x.png" alt="${desc}" class="w-6 h-6" />
                                    <span class="font-medium text-[var(--cane-800)] text-sm">${dayNames[idx]}</span>
                                </div>
                                <div class="text-right">
                                    <div class="text-[var(--cane-700)] font-semibold text-sm">${temp}</div>
                                    <div class="text-[var(--cane-600)] text-xs">${desc}</div>
                                </div>
                            </div>
                        `;
                    }).join('');
                
                weatherContainer.innerHTML = html;
            } catch (error) {
                console.error('Error fetching weather:', error);
                document.getElementById('weatherForecast').innerHTML = `<div class='text-[var(--cane-700)] bg-[var(--cane-50)] p-3 rounded-lg border border-[var(--cane-200)]'>Weather data unavailable.<br><span class='text-xs text-[var(--cane-600)]'>${error}</span></div>`;
            }
        }

        // Remove the old expand button
        const expandBtn = document.getElementById('expandMapBtn');
        if (expandBtn) expandBtn.style.display = 'none';

        // New expand/collapse icon logic
        const expandMapIcon = document.getElementById('expandMapIcon');
        const expandIcon = document.getElementById('expandIcon');
        const mainContent = document.getElementById('mainContent');
        const mapPanel = document.getElementById('mapPanel');
        const sidePanel = document.getElementById('sidePanel');
        let expanded = false;
        
        expandMapIcon.addEventListener('click', function() {
            expanded = !expanded;
            if (expanded) {
                sidePanel.style.display = 'none';
                mapPanel.classList.add('w-full');
                mainContent.classList.remove('flex', 'lg:flex-row', 'gap-8', 'px-4', 'pb-8');
                mainContent.classList.add('block', 'p-0');
                expandIcon.classList.remove('fa-expand');
                expandIcon.classList.add('fa-compress');
                document.getElementById('map').classList.remove('mb-6', 'rounded-lg', 'border', 'border-gray-200');
                document.getElementById('map').classList.add('h-[70vh]', 'w-full');
                
                // Refresh map when expanded
                if (map) {
                    setTimeout(() => map.invalidateSize(), 100);
                }
            } else {
                sidePanel.style.display = '';
                mapPanel.classList.remove('w-full');
                mainContent.classList.remove('block', 'p-0');
                mainContent.classList.add('flex', 'lg:flex-row', 'gap-8', 'px-4', 'pb-8');
                expandIcon.classList.remove('fa-compress');
                expandIcon.classList.add('fa-expand');
                document.getElementById('map').classList.remove('h-[70vh]', 'w-full');
                document.getElementById('map').classList.add('mb-6', 'rounded-lg', 'border', 'border-gray-200');
                
                // Refresh map when collapsed
                if (map) {
                    setTimeout(() => map.invalidateSize(), 100);
                }
            }
        });

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize map after a short delay to ensure DOM is ready
            setTimeout(() => {
                initMap();
            }, 100);
            
            getWeather();
            
            // Update user name from localStorage
            const userName = localStorage.getItem('farmerName') || 'Farmer Name';
            const userNameElements = document.querySelectorAll('#userName, #dropdownUserName');
            userNameElements.forEach(element => {
                if (element) element.textContent = userName;
            });
        });

        // Initialize Swiper
        const swiper = new Swiper('.featuresSwiper', {
            effect: 'coverflow',
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: 'auto',
            coverflowEffect: {
                rotate: 0,
                stretch: 0,
                depth: 100,
                modifier: 2,
                slideShadows: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            breakpoints: {
                640: {
                    slidesPerView: 2,
                },
                1024: {
                    slidesPerView: 3,
                },
            }
        });

        // Dynamic left panel content based on active slide
        function updateFeaturePanel(swiperInstance) {
            const active = swiperInstance.slides[swiperInstance.activeIndex];
            if (!active) return;
            const title = active.getAttribute('data-title') || 'CaneMap Features';
            const desc = active.getAttribute('data-desc') || '';
            const tags = (active.getAttribute('data-tags') || '').split(',').filter(Boolean);
            document.getElementById('featureTitle').textContent = title;
            document.getElementById('featureDesc').textContent = desc;
            const tagsContainer = document.getElementById('featureTags');
            tagsContainer.innerHTML = '';
            tags.forEach(function(tag) {
                const span = document.createElement('span');
                span.className = 'px-2 py-0.5 rounded bg-white/10 border border-white/10';
                span.textContent = tag.trim();
                tagsContainer.appendChild(span);
            });
        }

        updateFeaturePanel(swiper);
        swiper.on('slideChange', function () {
            updateFeaturePanel(swiper);

            // Crossfade background to the active slide image
            const active = swiper.slides[swiper.activeIndex];
            if (!active) return;
            const img = active.querySelector('img');
            if (!img) return;

            const bg = document.getElementById('featuresBg');
            const swap = document.getElementById('featuresBgSwap');
            if (!bg || !swap) return;

            // Prepare swap image
            swap.src = img.src;
            swap.classList.remove('opacity-0');
            swap.classList.add('opacity-40');

            // Fade out previous bg after transition
            setTimeout(function() {
                bg.src = swap.src;
                swap.classList.remove('opacity-40');
                swap.classList.add('opacity-0');
            }, 700);
        });

        // Scroll animations
        function animateOnScroll() {
            const elements = document.querySelectorAll('.fade-in-up, .fade-in-left, .fade-in-right, .scale-in, .slide-in-bottom');
            
            elements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < window.innerHeight - elementVisible) {
                    element.classList.add('animate');
                }
            });
        }
        
        // Add scroll event listener
        window.addEventListener('scroll', animateOnScroll);
        
        // Trigger animations on page load
        window.addEventListener('load', animateOnScroll);
        
        // Smooth scroll for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // Profile dropdown functionality
        const profileDropdownBtn = document.getElementById('profileDropdownBtn');
        const profileDropdown = document.getElementById('profileDropdown');
        const dropdownArrow = document.getElementById('dropdownArrow');
        
        if (profileDropdownBtn && profileDropdown) {
            profileDropdownBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                
                // Toggle dropdown visibility
                const isVisible = profileDropdown.classList.contains('opacity-100');
                
                if (isVisible) {
                    // Hide dropdown
                    profileDropdown.classList.remove('opacity-100', 'visible', 'scale-100');
                    profileDropdown.classList.add('opacity-0', 'invisible', 'scale-95');
                    dropdownArrow.style.transform = 'rotate(0deg)';
                } else {
                    // Show dropdown
                    profileDropdown.classList.remove('opacity-0', 'invisible', 'scale-95');
                    profileDropdown.classList.add('opacity-100', 'visible', 'scale-100');
                    dropdownArrow.style.transform = 'rotate(180deg)';
                }
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!profileDropdownBtn.contains(e.target) && !profileDropdown.contains(e.target)) {
                    profileDropdown.classList.remove('opacity-100', 'visible', 'scale-100');
                    profileDropdown.classList.add('opacity-0', 'invisible', 'scale-95');
                    dropdownArrow.style.transform = 'rotate(0deg)';
                }
            });
            
            // Close dropdown on escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    profileDropdown.classList.remove('opacity-100', 'visible', 'scale-100');
                    profileDropdown.classList.add('opacity-0', 'invisible', 'scale-95');
                    dropdownArrow.style.transform = 'rotate(0deg)';
                }
            });
        }
        
        // Scroll to top function
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
    </script>
</body>
</html>
